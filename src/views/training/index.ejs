<%- include("../partials/header", { title: "Training", nav: { isAuthed: true } }) %>

<h2>Training History</h2>
<p>All sessions logged for your account.</p>

<div class="actions">
  <a class="btn" style="padding:10px 12px; border-radius:10px;" href="/training/new">Add training session</a>
  <a class="btn btn-secondary" style="padding:10px 12px; border-radius:10px;" href="/training/export">Download as CSV</a>
</div>

<div class="card" style="margin-top:12px;">
  <table class="table">
    <tr>
      <th>Date</th>
      <th>Type</th>
      <th>Duration</th>
      <th>RPE</th>
      <th>Load</th>
      <th>Notes</th>
      <th style="width: 80px;"></th>
      <th style="width: 90px;"></th>
    </tr>

    <% sessions.forEach(s => { %>
      <tr>
        <td><%= s.SessionDate.toISOString().slice(0,10) %></td>
        <td><%= s.Type %></td>
        <td><%= s.DurationMin %> min</td>
        <td><%= s.RPE %></td>
        <td><%= s.SessionLoad %></td>
        <td><%= s.Notes || "" %></td>

        <td style="text-align:right;">
          <a style="padding:10px 12px; border-radius:10px;"
            href="/training/<%= s.SessionId %>/edit">
            Edit
          </a>
        </td>
        
        <td style="text-align:right;">
          <form method="POST"
                action="/training/<%= s.SessionId %>/delete"
                style="display:inline;"
                onsubmit="return confirm('Delete this session? This cannot be undone.');">
            <button type="submit"
                    style="padding:0px 12px; background:none; border:none; color:inherit; font:inherit; cursor:pointer;">
              Delete
            </button>
          </form>
        </td>


      </tr>
    <% }) %>
  </table>

  <% if (!sessions.length) { %>
    <p class="helper">No sessions yet. Add your first one to populate the dashboard.</p>
  <% } %>
</div>

<%- include("../partials/footer") %>
